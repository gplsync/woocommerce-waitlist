jQuery(document).ready(function(i){var t='<tr valign="top" class=""><th scope="row" class="titledesc">'+wcwl_settings.update_counts_desc+'</th><td class="forminp forminp-checkbox"><fieldset><legend class="screen-reader-text"><span>'+wcwl_settings.update_counts_desc+'</span></legend><button name="woocommerce_waitlist_update_counts" id="woocommerce_waitlist_update_counts" type="button" class="button">'+wcwl_settings.update_counts_button_text+'</button><span class="wcwl_settings_update_counts_text">'+wcwl_settings.update_warning+"</span></fieldset></td></tr>",e='<tr valign="top" class=""><th scope="row" class="titledesc">'+wcwl_settings.update_meta_desc+'</th><td class="forminp forminp-checkbox"><fieldset><legend class="screen-reader-text"><span>'+wcwl_settings.update_meta_desc+'</span></legend><button name="woocommerce_waitlist_update_meta" id="woocommerce_waitlist_update_meta" type="button" class="button">'+wcwl_settings.update_meta_button_text+'</button><span class="wcwl_settings_update_meta_text">'+wcwl_settings.update_warning+"</span></fieldset></td></tr>",s='<tr valign="top" class=""><th scope="row" class="titledesc">'+wcwl_settings.export_desc+'</th><td class="forminp forminp-checkbox"><fieldset><legend class="screen-reader-text"><span>'+wcwl_settings.export_desc+'</span></legend><button name="woocommerce_waitlist_export" id="woocommerce_waitlist_export" type="button" class="button">'+wcwl_settings.export_button_text+'</button><span class="wcwl_settings_export_text">'+wcwl_settings.export_text+"</span></fieldset></td></tr>",n=i('h2:contains("Waitlist Update Options")').next("table");i(e).prependTo(n),i(t).prependTo(n),i(".form-table").show(),i("#woocommerce_waitlist_update_counts").click(function(){if(window.confirm(wcwl_settings.confirmation_message)){c="count";var t={action:"wcwl_get_products",wcwl_get_products:wcwl_settings.get_products_nonce};i.post(ajaxurl,t,function(t){var n,o,c;0<(t=i.parseJSON(t)).length?(a(1,t.length),o=(n=t).length,c=0,function t(){if(0<n.length){var e=n.splice(0,10),s={action:"wcwl_update_counts",products:e,wcwl_update_counts:wcwl_settings.update_counts_nonce};i.post(ajaxurl,s,function(t){console.log(t),(c=parseInt(e.length)+parseInt(c))==o?_(o):l(c)}).done(function(){t()})}}()):alert(wcwl_settings.no_products_message)})}}),i("#woocommerce_waitlist_update_meta").click(function(){if(window.confirm(wcwl_settings.confirmation_message)){c="meta";var t={action:"wcwl_get_products",wcwl_get_products:wcwl_settings.get_products_nonce};i.post(ajaxurl,t,function(t){var n,o,c;0<(t=i.parseJSON(t)).length?(a(1,t.length),o=(n=t).length,c=0,function t(){if(0<n.length){var e=n.splice(0,10),s={action:"wcwl_update_meta",products:e,wcwl_update_meta:wcwl_settings.update_meta_nonce};i.post(ajaxurl,s,function(t){console.log(t),(c=parseInt(e.length)+parseInt(c))==o?_(o):l(c)}).done(function(){t()})}}()):alert("No products found.")})}});var o=i('h2:contains("Waitlist Admin Options")').next("table");i(s).appendTo(o),i("#woocommerce_waitlist_export").click(function(){r(),i('<span class="spinner is-active" style="float:none;"></span>').insertAfter("#woocommerce_waitlist_export");var t={action:"wcwl_get_products",wcwl_get_products:wcwl_settings.get_products_nonce};i.post(ajaxurl,t,function(t){var s,o,c,a;0<(t=i.parseJSON(t)).length?(o=(s=t).length,c=0,a="data:text/csv;charset=utf-8,Product ID,Product Name,Waitlist Emails,Archived Emails\r\n",function t(){if(0<s.length){var n=s.splice(0,10),e={action:"wcwl_generate_csv",products:n};i.post(ajaxurl,e,function(t){if(a+=t,(c=parseInt(n.length)+parseInt(c))==o){var e=document.createElement("a");e.setAttribute("type","hidden");var s=encodeURI(a);e.setAttribute("href",s),e.setAttribute("download","waitlist-export.csv"),document.body.appendChild(e),e.click(),i(".spinner.is-active").remove(),p()}}).done(function(){t()})}}()):(i(".spinner.is-active").remove(),p(),alert("No products found."))})});var c="";function a(t,e){r();var s="";"count"===c&&(s=wcwl_settings.update_counts_message),"meta"===c&&(s=wcwl_settings.update_meta_message),i('<div id="message" class="updated inline"><p><strong>'+s+"</strong></p></div>").insertBefore(n),i(".wcwl_current_update").text(t),i(".wcwl_total_updates").text(e)}function l(t){i(".wcwl_current_update").text(t)}function _(t){var e="";"count"===c&&(e=wcwl_settings.update_counts_message_complete),"meta"===c&&(e=wcwl_settings.update_meta_message_complete),i("#message p strong").html(e),i(".wcwl_total_updates").text(t),p()}function r(){i("#woocommerce_waitlist_update_counts, #woocommerce_waitlist_update_meta, #woocommerce_waitlist_export, .woocommerce-save-button").prop("disabled",!0)}function p(){i("#woocommerce_waitlist_update_counts, #woocommerce_waitlist_update_meta, #woocommerce_waitlist_export, .woocommerce-save-button").prop("disabled",!1)}});